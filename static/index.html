<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Birthday Wish</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div class="background"></div>
    <div class="content">
        <h1 id="hint"><center>Untangle the wrapper. Unlock the wonder</center></h1>
        <form class="password-form" onsubmit="event.preventDefault(); submitPassword();">
            <input type="password" id="password" placeholder="Enter password..." autocomplete="off" />
            <button type="submit" id="submit-btn">Submit</button>
        </form>
        <div id="message"></div>
        <div id="confetti"></div>
        <div id="crying"></div>
    </div>

    <script>
        function submitPassword() {
            let pwd = document.getElementById("password").value;
            fetch("/check", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: "password=" + encodeURIComponent(pwd)
            })
            .then(res => res.text())
            .then(res => {
                // Clear existing animations and messages
                document.getElementById("confetti").innerHTML = "";
                document.getElementById("crying").innerHTML = "";
                document.getElementById("message").innerText = "";

                if (res === "correct") {
                    showConfetti();
                    document.getElementById("message").innerText = "You cracked it!";
                    setTimeout(() => {
                        window.location.href = "pdf.html"; // Go to PDF screen after confetti
                    }, 1200);
                } else {
                    showCrying();
                    document.getElementById("message").innerText = "Try Again!";
                }
            });
        }

        function showConfetti() {
            let confetti = "";
            for (let i = 0; i < 40; i++) {
                confetti += `<span style="
                  position: absolute;
                  top: ${Math.random() * 100}vh;
                  left: ${Math.random() * 100}vw;
                  font-size: ${Math.random() * 24 + 16}px;
                  color: hsl(${Math.random() * 360},85%,65%);
                  animation: fall 2s linear infinite;
                  ">&#127881;</span>`; // ðŸŽ‰
            }
            document.getElementById("confetti").innerHTML = confetti;
        }

        function showCrying() {
            let crying = "";
            for (let i = 0; i < 40; i++) {
                crying += `<span style="
                  position: absolute;
                  top: ${Math.random() * 100}vh;
                  left: ${Math.random() * 100}vw;
                  font-size: ${Math.random() * 24 + 16}px;
                  animation: fall 2s linear infinite;
                  ">&#128557;</span>`; // ðŸ˜­
            }
            document.getElementById("crying").innerHTML = crying;
        }
    </script>
</body>
</html>
